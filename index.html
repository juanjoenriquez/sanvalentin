<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Juanjo üíò Kriz</title>

<style>
:root{
  --bg1:#f7d4dc;
  --bg2:#f3c7cf;
  --glass1: rgba(255,255,255,.62);
  --glass2: rgba(255,255,255,.34);
  --ink: rgba(0,0,0,.80);
  --muted: rgba(0,0,0,.58);
  --shadow: 0 18px 55px rgba(0,0,0,.16);
  --shadow2: 0 10px 28px rgba(0,0,0,.10);
  --accent:#ff2d55;
  --accent2:#ff7aa2;
  --ok:#00c389;
}

*{ box-sizing:border-box; }
html,body{ height:100%; }

body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background:
    radial-gradient(900px 650px at 18% 12%, rgba(255,255,255,.55), transparent 62%),
    radial-gradient(900px 650px at 78% 18%, rgba(255,255,255,.35), transparent 62%),
    linear-gradient(145deg, var(--bg1), var(--bg2));
  overflow:hidden; /* el scroll es interno */
  color: var(--ink);
}

.frame{
  position:relative;
  width:min(980px, 96vw);
  height:100vh;
  margin:auto;
  border-radius: 26px;
  overflow:hidden;
  box-shadow: var(--shadow);
}

canvas{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  z-index:1;
  pointer-events:none;
}

.screen{
  position:absolute;
  inset: 0;
  z-index: 3;
  display:block;
  overflow-y:auto;                 /* ‚úÖ scroll iPhone */
  -webkit-overflow-scrolling:touch;
  padding: 22px;
}

.card{
  width:min(860px, 92vw);
  margin: 0 auto;
  border-radius: 26px;
  background: linear-gradient(180deg, var(--glass1), var(--glass2));
  border: 1px solid rgba(255,255,255,.70);
  box-shadow: var(--shadow2);
  padding: 26px;
  max-height: calc(100vh - 44px);
  overflow-y:auto;
  -webkit-overflow-scrolling:touch;
  position:relative;
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
}

.badges{
  display:flex;
  justify-content:space-between;
  gap:10px;
  align-items:center;
  margin-bottom: 14px;
}
.badge{
  display:inline-flex;
  gap:8px;
  align-items:center;
  padding:10px 12px;
  border-radius:999px;
  background: rgba(255,255,255,.66);
  border: 1px solid rgba(255,255,255,.75);
  box-shadow: 0 10px 22px rgba(0,0,0,.08);
  font-size: 13px;
  font-weight: 900;
  color: rgba(0,0,0,.62);
}

.title{
  font-size: clamp(22px, 3.2vw, 32px);
  font-weight: 1000;
  text-align:center;
  margin: 10px 0 8px;
  position:relative;
  z-index:2;
}
.subtitle{
  text-align:center;
  color:var(--muted);
  margin: 0 0 18px;
  font-weight: 800;
  line-height:1.35;
  position:relative;
  z-index:2;
}

/* Animaci√≥n sutil de ‚Äúrespirar‚Äù en el fondo */
.card:before{
  content:"";
  position:absolute; inset:-40px;
  background:
    radial-gradient(520px 340px at 30% 22%, rgba(255,45,85,.18), transparent 60%),
    radial-gradient(520px 340px at 70% 70%, rgba(255,122,162,.16), transparent 62%);
  filter: blur(10px);
  opacity:.85;
  animation: breathe 6.5s ease-in-out infinite;
  pointer-events:none;
}
@keyframes breathe{
  0%,100%{ transform: translateY(0) scale(1); opacity:.82; }
  50%{ transform: translateY(-6px) scale(1.02); opacity:.92; }
}

/* INTRO */
.introWrap{
  display:grid;
  place-items:center;
  gap: 14px;
  padding: 10px 0 0;
  position:relative;
  z-index:2;
}
.heartBtn{
  width: 150px;
  height: 150px;
  border-radius: 999px;
  border: 0;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
  background:
    radial-gradient(circle at 35% 30%, rgba(255,255,255,.92), rgba(255,255,255,.25));
  box-shadow: 0 18px 45px rgba(0,0,0,.12);
  position:relative;
  display:grid;
  place-items:center;
  user-select:none;
  animation: floaty 3.8s ease-in-out infinite;
}
@keyframes floaty{
  0%,100%{ transform: translateY(0); }
  50%{ transform: translateY(-6px); }
}
.bigHeart{
  width: 60px;
  height: 60px;
  transform: rotate(-45deg);
  background: linear-gradient(180deg, var(--accent2), var(--accent));
  position:relative;
  filter: drop-shadow(0 14px 24px rgba(255,45,85,.25));
  animation: beat 1.08s ease-in-out infinite;
}
.bigHeart:before,.bigHeart:after{
  content:"";
  position:absolute;
  width:60px;height:60px;border-radius:50%;
  background:inherit;
}
.bigHeart:before{ top:-30px; left:0; }
.bigHeart:after{ left:30px; top:0; }
@keyframes beat{
  0%,100%{ transform: rotate(-45deg) scale(1); }
  50%{ transform: rotate(-45deg) scale(1.12); }
}
.hint{
  font-weight: 850;
  color: rgba(0,0,0,.55);
  font-size: 13px;
  text-align:center;
  line-height:1.35;
  position:relative;
  z-index:2;
}

/* BOTONES */
.btnArea{
  position:relative;
  display:flex;
  justify-content:center;
  align-items:center;
  gap: 14px;
  margin-top: 14px;
  min-height: 150px;
  z-index:2;
}
.btn{
  border:0;
  cursor:pointer;
  border-radius: 16px;
  padding: 14px 18px;
  font-weight: 1000;
  font-size: 16px;
  box-shadow: 0 14px 30px rgba(0,0,0,.12);
  transition: transform .12s ease, filter .12s ease;
  -webkit-tap-highlight-color: transparent;
  user-select:none;
  touch-action: manipulation;
  position:relative;
  white-space:nowrap;
}
.btn:active{ transform: scale(.98); }
.btnYes{
  background: linear-gradient(180deg, rgba(0,195,137,.98), rgba(0,160,115,.98));
  color: rgba(255,255,255,.96);
}
.btnNo{
  background: rgba(255,255,255,.78);
  color: rgba(0,0,0,.72);
  border: 1px solid rgba(255,255,255,.75);
}

/* RESULT */
.panel{
  border-radius: 22px;
  padding: 18px;
  background: rgba(255,255,255,.58);
  border: 1px solid rgba(255,255,255,.72);
  box-shadow: 0 10px 24px rgba(0,0,0,.08);
  margin-top:18px;
  position:relative;
  z-index:2;
}
.loveText{
  white-space:pre-wrap;
  line-height: 1.55;
  color: rgba(0,0,0,.72);
  font-weight: 780;
  font-size: 16px;
}
.timerGrid{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap: 10px;
  margin-top: 12px;
}
.tile{
  background: rgba(255,255,255,.78);
  border: 1px solid rgba(255,255,255,.80);
  padding: 14px;
  border-radius: 18px;
  text-align:center;
}
.num{ font-size: 32px; font-weight: 1100; }
.lab{ font-size: 12px; color: var(--muted); font-weight: 900; }

.controls{
  display:flex;
  justify-content:center;
  gap:10px;
  margin-top: 12px;
  flex-wrap:wrap;
}
.smallBtn, .linkBtn{
  padding: 10px 12px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.75);
  background: rgba(255,255,255,.70);
  font-weight: 950;
  cursor:pointer;
  box-shadow: 0 10px 22px rgba(0,0,0,.08);
  text-decoration:none;
  color: rgba(0,0,0,.72);
  display:inline-flex;
  align-items:center;
  gap:8px;
}

.spotifyWrap{
  margin-top: 12px;
  border-radius: 16px;
  overflow:hidden;
  border: 1px solid rgba(255,255,255,.75);
  box-shadow: 0 10px 24px rgba(0,0,0,.08);
  background: rgba(255,255,255,.6);
}
.spotifyWrap iframe{
  width:100%;
  height: 86px;
  border:0;
  display:block;
}

.toast{
  position: sticky;
  bottom: 8px;
  margin: 12px auto 0;
  width: fit-content;
  max-width: 92%;
  background: rgba(255,255,255,.82);
  border: 1px solid rgba(255,255,255,.78);
  box-shadow: 0 12px 30px rgba(0,0,0,.12);
  padding: 10px 12px;
  border-radius: 14px;
  font-weight: 900;
  font-size: 13px;
  color: rgba(0,0,0,.68);
  opacity:0;
  transform: translateY(6px);
  transition: opacity .25s ease, transform .25s ease;
  text-align:center;
  z-index: 9;
}
.toast.show{ opacity:1; transform: translateY(0); }

.hidden{ display:none !important; }
</style>
</head>

<body>
<div class="frame">
  <canvas id="fx"></canvas>

  <div class="screen">
    <div class="card">

      <div class="badges">
        <div class="badge">üíñ Interactivo</div>
        <div class="badge" id="badgeRight">Toca el coraz√≥n</div>
      </div>

      <!-- STEP 1 -->
      <section id="step1">
        <div class="title">Kriz‚Ä¶ tengo una pregunta para ti</div>
        <div class="subtitle">Toca el coraz√≥n y deja que el momento haga lo suyo ‚ú®</div>

        <div class="introWrap">
          <button class="heartBtn" id="heartStart" type="button" aria-label="Tocar coraz√≥n">
            <div class="bigHeart"></div>
          </button>
          <div class="hint">Despu√©s podr√°s lanzar corazones tocando la pantalla üíó</div>
        </div>
      </section>

      <!-- STEP 2 -->
      <section id="step2" class="hidden">
        <div class="title">¬øQuieres ser mi Valent√≠n? üíò</div>
        <div class="subtitle">Resp√≥ndeme con el coraz√≥n‚Ä¶</div>

        <div class="btnArea" id="btnArea">
          <button class="btn btnYes" id="yesBtn" type="button">S√≠, quiero üíó</button>
          <button class="btn btnNo" id="noBtn" type="button">No‚Ä¶</button>
        </div>

        <div class="hint">Spoiler: el ‚ÄúNo‚Äù no se deja presionar ü§≠</div>
      </section>

      <!-- STEP 3 -->
      <section id="step3" class="hidden">
        <div class="panel">
          <div class="title" style="margin:0 0 8px;">Kriz ‚ù§Ô∏è</div>
          <p class="loveText" id="loveText"></p>
          <div style="font-weight:1000; color:rgba(0,0,0,.70); margin-top:10px;">‚Äî Juanjo</div>

          <div class="controls" style="margin-top:14px;">
            <button class="smallBtn" id="burstBtn">üí• M√°s corazones</button>
            <a class="linkBtn" target="_blank" rel="noopener"
               href="https://open.spotify.com/track/3WVIg40TvL2dGBHShZD8f7">
              üéß Abrir en Spotify
            </a>
          </div>

          <div class="spotifyWrap" aria-label="Reproductor Spotify">
            <iframe
              src="https://open.spotify.com/embed/track/3WVIg40TvL2dGBHShZD8f7?utm_source=generator"
              allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
              loading="lazy">
            </iframe>
          </div>

          <div class="hint" style="margin-top:10px;">
            Nota: por pol√≠ticas de iPhone/Spotify, toca ‚ñ∂Ô∏è en el reproductor para que suene.
          </div>
        </div>

        <div class="panel">
          <div style="font-weight:1000; color:rgba(0,0,0,.62);">Mi amor por ti comenz√≥ hace‚Ä¶</div>

          <div class="timerGrid">
            <div class="tile"><div class="num" id="d">0</div><div class="lab">d√≠as</div></div>
            <div class="tile"><div class="num" id="h">00</div><div class="lab">horas</div></div>
            <div class="tile"><div class="num" id="m">00</div><div class="lab">minutos</div></div>
            <div class="tile"><div class="num" id="s">00</div><div class="lab">segundos</div></div>
          </div>

          <div class="hint" style="margin-top:10px;">Tip: toca la pantalla para explotar corazones üíó</div>
        </div>
      </section>

      <div class="toast" id="toast">üíå</div>

    </div>
  </div>
</div>

<script>
/* ========= CONFIG ========= */
const CONFIG = {
  fromName: "Juanjo",
  toName: "Kriz",
  startDate: "2022-10-01T00:00:00-05:00",
  // EmailJS opcional:
  // EMAILJS_PUBLIC_KEY: "TU_PUBLIC_KEY",
  // EMAILJS_SERVICE_ID: "TU_SERVICE_ID",
  // EMAILJS_TEMPLATE_ID: "TU_TEMPLATE_ID",
  // notifyEmail: "ing.juanjoenriquez@gmail.com",
};

const LOVE_MESSAGE =
`Si pudiera escoger un lugar seguro, ser√≠a a tu lado.
Contigo entend√≠ que el amor no es ruido, es paz. Es esa confianza silenciosa de saber que, pase lo que pase, estamos en el mismo equipo.

Gracias por tu forma de mirar, por tu paciencia cuando yo me acelero, y por esa ternura que aparece cuando menos la espero.

Hoy no te escribo para impresionarte, te escribo para recordarte algo simple:
me haces bien‚Ä¶ y por eso te elijo, todos los d√≠as.

Te amo. üíó`;

const $ = (id)=>document.getElementById(id);
const step1 = $("step1"), step2 = $("step2"), step3 = $("step3");
const badgeRight = $("badgeRight");
const toast = $("toast");

/* ========= TOAST ========= */
function showToast(text){
  toast.textContent = text;
  toast.classList.add("show");
  clearTimeout(showToast._t);
  showToast._t = setTimeout(()=>toast.classList.remove("show"), 1400);
}

/* ========= CANVAS FX ========= */
const canvas = $("fx");
const ctx = canvas.getContext("2d", { alpha:true });
let W=0,H=0,DPR=1;
function resize(){
  DPR = Math.min(2, window.devicePixelRatio || 1);
  W = canvas.clientWidth = canvas.parentElement.clientWidth;
  H = canvas.clientHeight = canvas.parentElement.clientHeight;
  canvas.width = Math.floor(W * DPR);
  canvas.height = Math.floor(H * DPR);
  ctx.setTransform(DPR,0,0,DPR,0,0);
}
window.addEventListener("resize", resize);
resize();

const palette = ["#ff2d55","#ff7aa2","#ff4f79","#ffd166","#ff8fab","#ffb3c7"];
const parts = [];
let running = false;
let last = performance.now();

function rand(a,b){ return a + Math.random()*(b-a); }

function drawHeart(x,y,s,rot,color,alpha){
  ctx.save();
  ctx.globalAlpha = alpha;
  ctx.translate(x,y);
  ctx.rotate(rot);
  ctx.scale(s,s);
  ctx.beginPath();
  ctx.moveTo(0, -8);
  ctx.bezierCurveTo(8, -14, 16, -2, 0, 16);
  ctx.bezierCurveTo(-16, -2, -8, -14, 0, -8);
  ctx.closePath();
  const g = ctx.createRadialGradient(-3,-6,2, 0,0,20);
  g.addColorStop(0, "rgba(255,255,255,.55)");
  g.addColorStop(0.35, color);
  g.addColorStop(1, "rgba(0,0,0,.12)");
  ctx.fillStyle = g;
  ctx.fill();
  ctx.restore();
}

function spawn(x,y,power=1){
  parts.push({
    x,y,
    vx: rand(-45,45)*power,
    vy: rand(-240,-120)*power,
    g: rand(320,520),
    s: rand(0.55,1.05),
    r: rand(0,6.28),
    spin: rand(-2,2),
    a: rand(0.65,0.95),
    c: palette[(Math.random()*palette.length)|0],
    life: rand(1.0,1.8),
  });
  if(parts.length > 340) parts.splice(0, parts.length-340);
}
function burst(x,y,n=28){
  for(let i=0;i<n;i++) spawn(x,y, rand(0.75,1.2));
}
function startLoop(){
  if(running) return;
  running = true;
  requestAnimationFrame(loop);
}
function loop(t){
  const dt = Math.min(0.03, (t-last)/1000);
  last = t;
  ctx.clearRect(0,0,W,H);

  ctx.save();
  ctx.globalAlpha = 0.12;
  const glow = ctx.createRadialGradient(W*0.5,H*0.35,20, W*0.5,H*0.35, Math.min(W,H)*0.62);
  glow.addColorStop(0,"rgba(255,255,255,.65)");
  glow.addColorStop(1,"rgba(255,255,255,0)");
  ctx.fillStyle = glow;
  ctx.fillRect(0,0,W,H);
  ctx.restore();

  for(let i=parts.length-1;i>=0;i--){
    const p = parts[i];
    p.life -= dt;
    p.vy += p.g*dt;
    p.x += p.vx*dt;
    p.y += p.vy*dt;
    p.r += p.spin*dt;
    drawHeart(p.x,p.y,p.s,p.r,p.c,p.a);
    if(p.life<=0 || p.y>H+140 || p.x<-140 || p.x>W+140) parts.splice(i,1);
  }

  if(running) requestAnimationFrame(loop);
}

/* ========= FLOW ========= */
$("loveText").textContent = LOVE_MESSAGE;

$("heartStart").addEventListener("click", ()=>{
  startLoop();
  badgeRight.textContent = "Resp√≥ndeme‚Ä¶";
  step1.classList.add("hidden");
  step2.classList.remove("hidden");
  burst(W*0.5, H*0.45, 18);
  showToast("üíò Te tengo una pregunta");
});

/* NO imposible */
const noBtn = $("noBtn");
const yesBtn = $("yesBtn");
const btnArea = $("btnArea");

function moveNo(){
  const area = btnArea.getBoundingClientRect();
  const btn = noBtn.getBoundingClientRect();
  const maxX = Math.max(0, area.width - btn.width);
  const maxY = Math.max(0, area.height - btn.height);

  const x = rand(0, maxX);
  const y = rand(0, maxY);

  noBtn.style.position = "absolute";
  noBtn.style.left = `${x}px`;
  noBtn.style.top = `${y}px`;

  const phrases = ["üò≥ ¬øSegura?", "ü§≠ No me hagas eso", "üíò Vamos‚Ä¶", "ü•∫ Yo s√≠ te elijo", "üôà Int√©ntalo otra vez"];
  showToast(phrases[(Math.random()*phrases.length)|0]);

  const rect = canvas.getBoundingClientRect();
  burst((area.left + x + btn.width/2) - rect.left, (area.top + y + btn.height/2) - rect.top, 10);
}
noBtn.addEventListener("mouseenter", moveNo);
noBtn.addEventListener("pointerdown", (e)=>{ e.preventDefault(); moveNo(); }, { passive:false });
noBtn.addEventListener("click", (e)=>{ e.preventDefault(); moveNo(); });

/* YES */
yesBtn.addEventListener("click", ()=>{
  badgeRight.textContent = "üíñ";
  step2.classList.add("hidden");
  step3.classList.remove("hidden");
  burst(W*0.5, H*0.52, 70);
  showToast("üíó Te amo");
});

/* EXTRA */
$("burstBtn").addEventListener("click", ()=>{
  burst(W*0.5, H*0.50, 55);
  showToast("üí• Boom");
});
document.addEventListener("click", (e)=>{
  if(step3.classList.contains("hidden")) return;
  const r = canvas.getBoundingClientRect();
  burst(e.clientX - r.left, e.clientY - r.top, 16);
});

/* TIMER */
const start = new Date(CONFIG.startDate).getTime();
function pad2(n){ return String(n).padStart(2,"0"); }
function tick(){
  const now = Date.now();
  let diff = Math.max(0, now - start);
  const sec = Math.floor(diff/1000);

  const days = Math.floor(sec / 86400);
  const hours = Math.floor((sec % 86400) / 3600);
  const mins = Math.floor((sec % 3600) / 60);
  const secs = sec % 60;

  $("d").textContent = days;
  $("h").textContent = pad2(hours);
  $("m").textContent = pad2(mins);
  $("s").textContent = pad2(secs);
}
setInterval(tick, 1000);
tick();

showToast("üíó Toca el coraz√≥n");
</script>
</body>
</html>
